### The Initial URL
### The Connection URL
The HTTP handler within Metasploit will receive the request for the initial URL, determine which
```INIT_*```

checksum it correlates to, extract any embedded [[Payload UUID]], and then respond with either the second stage for staged payloads or a new URL for stageless payloads. The new URL is generated by the handler, will embed any Payload UUID that was included in the original request, and will hash to the value defined by the
```URI_CHECKSUM_CONN```

### TLS Certificate Pinning
The Meterpreter HTTPS transport supports certificate pinning. This applies to the stageless payloads as well as Meterpreter payloads loaded with the
```reverse_winhttps```

stagers. At this time, some of the non-Windows stagers also support certificate pinning, but this is still a work in progress. Certificate pinning is enabled by setting the
```StagerVerifySSLCert```

option to
```true```

and by extracting a SHA1 hash of the certificate specified in the
```HandlerSSLCert```

The command below generates a custom unified PEM TLS certificate that works with the
```HandlerSSLCert```

option:
```
$ openssl req -new -newkey rsa:4096 -days 365 -nodes -x509 \
    -subj "/C=US/ST=Texas/L=Austin/O=Development/CN=www.example.com" \
    -keyout www.example.com.key \
    -out www.example.com.crt && \
cat www.example.com.key  www.example.com.crt > www.example.com.pem && \
rm -f www.example.com.key  www.example.com.crt
```

