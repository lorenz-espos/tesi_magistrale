### Requirements
### Usage
* To add PowerShell to your module, first you need to require it:
```ruby
require 'msf/core/exploit/powershell'
```

* And then include the mixin within the scope of the
```Metasploit3```

class (or maybe
```Metasploit4```

for some)
```ruby
include Msf::Exploit::Powershell
```

* Use the
```cmd_psh_payload```

method to generate the PowerShell payload.
```ruby
cmd_psh_payload(payload.encoded, payload_instance.arch.first)
```

The actual output of
```cmd_psh_payload```

is a system command, which would look like the following format (as a one-liner):
```
%COMSPEC% /B /C start powershell.exe -Command $si = New-Object
System.Diagnostics.ProcessStartInfo;$si.FileName = 'powershell.exe';
$si.Arguments = ' -EncodedCommand [BASE64 PAYLOAD] ';
$si.UseShellExecute = $false;
$si.RedirectStandardOutput = $true;$si.WindowStyle = 'Hidden';
$si.CreateNoWindow = $True;
$p = [System.Diagnostics.Process]::Start($si);
```

